<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <title>Talaba Davomati</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }

        .student-button {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background-color: #e0e0e0; /* Default background */
            color: black;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
            position: relative; /* Needed for dropdown positioning */
        }

        .dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100%;
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .dropdown button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: white;
            border: none;
            text-align: left;
            cursor: pointer;
        }

        .dropdown button:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Lingvistika Talabalari</h1>

        <!-- Example buttons -->
        <div class="student-button" onclick="toggleDropdown(this)" data-id="rasulova-zebiniso">
            Rasulova Zebiniso
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="axtamova-aziza">
            Axtamova Aziza
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="maxamadjonova-moxichexra">
            Maxamadjonova Moxichexra
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="masharifov-doniyor">
            Masharifov Doniyor
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="mamirov-asadbek">
            Mamirov Asadbek
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="yusupova-dilorom">
            Yusupova Dilorom
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="ilyosova-munisa">
            Ilyosova Munisa
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="rajapboyeva-dildora">
            Rajapboyeva Dildora
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="rustamova-sharifa">
            Rustamova Sharifa
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="kamoldinova-muqaddasxon">
            Kamoldinova Muqaddasxon
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="alimkulov-nomonjon">
            Alimkulov No'monjon
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>

        <div class="student-button" onclick="toggleDropdown(this)" data-id="saidkarimova-ezozaxon">
            Saidkarimova E'zozaxon
            <div class="dropdown">
                <button onclick="selectStatus(event, this, 'keldi')">Keldi</button>
                <button onclick="selectStatus(event, this, 'kelmadi')">Kelmadi</button>
                <button onclick="selectStatus(event, this, 'sababli')">Sababli</button>
            </div>
        </div>
    </div>

    <script>
    // Object to store student statuses
    const studentStatuses = {};

    function toggleDropdown(button) {
        // Close all other dropdowns
        const allDropdowns = document.querySelectorAll('.dropdown');
        allDropdowns.forEach(dropdown => {
            if (dropdown.parentElement !== button) {
                dropdown.style.display = 'none';
            }
        });

        // Toggle the dropdown for the clicked button
        const dropdown = button.querySelector('.dropdown');
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    function selectStatus(event, option, status) {
        event.stopPropagation();

        const button = option.closest('.student-button');
        const studentId = button.getAttribute('data-id'); // Get the unique ID
        const studentName = button.childNodes[0].textContent.trim(); // Get the student name

        // Save the status in the studentStatuses object
        studentStatuses[studentId] = { name: studentName, status: status };

        // Update button styles based on status
        switch (status) {
            case 'keldi':
                button.style.backgroundColor = 'green';
                button.style.color = 'white';
                break;
            case 'kelmadi':
                button.style.backgroundColor = 'red';
                button.style.color = 'white';
                break;
            case 'sababli':
                button.style.backgroundColor = 'yellow';
                button.style.color = 'black';
                break;
            default:
                button.style.backgroundColor = '#e0e0e0';
                button.style.color = 'black';
        }

        // Close the dropdown
        const dropdown = button.querySelector('.dropdown');
        dropdown.style.display = 'none';
    }

    function submitData() {
    const selectedField = localStorage.getItem('selectedField');
    console.log(selectedField);
    // Log the student statuses to the console (for testing)
    console.log("Submitting Data:", studentStatuses);

    // Prepare the data to be sent to the server
    const dataToSend = { date: sessionStorage.getItem('selectedDate') ,
        field: selectedField}; // Example: Date will be the same for all students in this case
    // Add each student's data to the request
    Object.keys(studentStatuses).forEach(studentId => {
        dataToSend[studentId] = {
            name: studentStatuses[studentId].name,
            status: studentStatuses[studentId].status,
        };
    });

    // Example: Send data to the server
    fetch('http://localhost:3000/submit-attendance', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(dataToSend),
    })
    .then(response => response.json())
    .then(data => {
        console.log('Success:', data);
        alert('Attendance submitted successfully!');
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Failed to submit attendance.');
    });
}


    // Close dropdowns when clicking outside
    document.addEventListener('click', function (event) {
        const dropdowns = document.querySelectorAll('.dropdown');
        dropdowns.forEach(dropdown => {
            if (!dropdown.contains(event.target) &&
                !dropdown.parentElement.contains(event.target)) {
                dropdown.style.display = 'none';
            }
        });
    });
    </script>
    <button onclick="submitData()" style="margin-top: 20px; padding: 10px 20px; background-color: blue; color: white; border: none; border-radius: 5px; cursor: pointer;">
        Tugatdim, saqlayvering!
    </button>

</body>
</html>
